#include "bitonic_sort.hpp"
#include "config.hpp"
#include "utils.hpp"
#include <gtest/gtest.h>
#include <vector>
#include <CL/opencl.hpp>

TEST(NAIVE_KERNEL, test_1) {
    std::vector<int> data {
        -596182,
        -798199,
        -1574142,
        -30307,
        1284444,
        -952049,
        -1796849,
        -1033270
    };

    ocl_utils::Environment env(config::KERNELS_PATH + config::NAIVE_BITONIC_KERNEL, config::NAIVE_BITONIC_KERNEL_NAME);
    bitonic::sort(env, data);

    std::vector<int> reference {
        -1796849,
        -1574142,
        -1033270,
        -952049,
        -798199,
        -596182,
        -30307,
        1284444
    };

    ASSERT_EQ(data, reference);
}

TEST(NAIVE_KERNEL, test_2) {
    std::vector<int> data {
        -539505, -1193354, -208961, -1470294, -790260, -148734, 1797418, 708185, -38016, 938533, -768538, 49269, 1154596, -229249, -868314, -1406368, 611468, -1319694, 72663, -292238, 1112098, -809794, -605579, 422085, -1456826, -1445498, -273417, 312901, -1807656, 1362499, -809451, 991979, -412051, 1901032, -1733355, 307778, -1570628, -1205356, -543517, -1834755, -1564200, 1012243, -789275, 1573868, 1061467, -1422976, 371311, 248478, 1433772, -161526, 463799, -1563151, -642922, -598553, 1686986, 1451552, -1207150, -1177999, -1786586, 1141822, -990335, -1399520, 879269, -1124299, 1566975, -1173368, -1795668, -496927, -1950037, 110122, 1694350, 388130, 1452929, 875315, -1458148, 212040, -1886264, 1177940, 1435553, 861247, -1436228, 1484707, -450377, 264773, 1014566, -834282, -1618855, -47112, 1201222, 1119274, 1412134, -1095795, -431265, 1175053, 780535, -865296, 1012290, -590309, -370819, -1489164, -714140, 998615, -1547007, 843472, -1954017, -176568, -1684348, -130573, 207286, 560866, 605405, 1554003, 1839194, -137326, -969749, -492190, 459603, 316961, -144860, -1783058, 990142, 1247004, 1699720, -1704467, -1564167, 692694, 1163166, -311451
    };

    ocl_utils::Environment env(config::KERNELS_PATH + config::NAIVE_BITONIC_KERNEL, config::NAIVE_BITONIC_KERNEL_NAME);
    bitonic::sort(env, data);

    std::vector<int> reference {
        -1954017, -1950037, -1886264, -1834755, -1807656, -1795668, -1786586, -1783058, -1733355, -1704467, -1684348, -1618855, -1570628, -1564200, -1564167, -1563151, -1547007, -1489164, -1470294, -1458148, -1456826, -1445498, -1436228, -1422976, -1406368, -1399520, -1319694, -1207150, -1205356, -1193354, -1177999, -1173368, -1124299, -1095795, -990335, -969749, -868314, -865296, -834282, -809794, -809451, -790260, -789275, -768538, -714140, -642922, -605579, -598553, -590309, -543517, -539505, -496927, -492190, -450377, -431265, -412051, -370819, -311451, -292238, -273417, -229249, -208961, -176568, -161526, -148734, -144860, -137326, -130573, -47112, -38016, 49269, 72663, 110122, 207286, 212040, 248478, 264773, 307778, 312901, 316961, 371311, 388130, 422085, 459603, 463799, 560866, 605405, 611468, 692694, 708185, 780535, 843472, 861247, 875315, 879269, 938533, 990142, 991979, 998615, 1012243, 1012290, 1014566, 1061467, 1112098, 1119274, 1141822, 1154596, 1163166, 1175053, 1177940, 1201222, 1247004, 1362499, 1412134, 1433772, 1435553, 1451552, 1452929, 1484707, 1554003, 1566975, 1573868, 1686986, 1694350, 1699720, 1797418, 1839194, 1901032
    };

    ASSERT_EQ(data, reference);
}

TEST(NAIVE_KERNEL, test_3) {
    std::vector<int> data {
         -260403, 1934371, -958939, -270448, -1010844, 887992, -398748, 1310593, 63776, 245981, 814717, -267901, -899417, -1432918, -855449, -1630267, -202457, -787881, 417468, 1824265, 519762, 1183668, 15078, -1339067, -733363, -690423, 302980, 1032658, 1038834, 51378, 1702006, 929402, -1176596, 786998, -581293, -1957641, -598723, -192392, -1399435, -622932, 1172242, -167203, 746941, 1791264, 1638584, 1271566, 175810, 1238865, 97921, 1887106, -1277410, -867020, -79332, -1167107, 1674644, -1474606, 585030, -524333, -1716336, -926778, -1993435, 1512630, -812489, 1613349, 1410662, -15497, 602579, -1591381, -133871, -1930, -932204, 580447, -961431, 1160539, -1371275, 1836744, 941125, 1041865, -672546, -288404, 736397, 1497813, -1476315, -117299, -3363, 1196450, -611641, -32425, -1106452, 1083934, 1014901, -135098, 521826, 1198251, 410399, -314922, 1601146, -759023, -274604, -1468640, -858403, -1243663, -56922, 1740319, 1074425, 151496, 668884, -1025837, -1120519, 576102, 778325, -1647076, 723855, 1653825, -763895, 1644816, -737973, -1779891, -1902188, -1077352, 978467, -453035, -1312158, -1918659, 930526, 779234, -1127639, -521145, 1061270, -408890, 763142, 1467186, 1336044, -368114, 1277713, 824532, -738596, -676001, -772243, -376339, 80107, 59602, 1852507, 937891, -1303920, 1345225, -66217, -1455598, 8660, 1144432, 1245353, 1368931, -354338, 1768294, -204379, 1725193, -1635697, -1264006, -1721934, 1565434, 1716912, 765883, 598579, -561688, -1098491, -1088161, -1487366, 304875, 464685, -991117, 1753370, -507553, 875822, 1923822, -1188122, 1772934, 1217849, -851010, -1846757, -917419, 534530, -1892777, -1036084, -1688228, 812326, -359697, -525116, -209543, 1847703, 1514566, 1939005, 840851, -757299, 1582997, 575958, -1202447, 1585633, 641092, -891188, 1375225, 917146, -1152135, -11306, -296765, 1823178, 1470185, -358875, -1765320, 177201, 1918266, -831698, 490717, 1394847, -1466594, -469059, -801873, -509802, -1111825, -253833, 307360, 712136, 1454490, -109828, -1531091, -541048, -375866, -799161, -1835269, 999497, 1806076, 167694, -1573414, -1143796, 837330, -1285670, -386089, 1896479, 1499831, 458905, 1510287, -718431, 407530, 1040105, 313432, -953499, -206031, 1195022, -96470, -1750687, 1492089, 171917, -1955752, -1555570, 883051, -1317066, -664174, 568517, -282059, 1434366, -1036894, 301110, 1194841, -545672, -306346, 1121833, -1070773, 147065, 965371, 1076390, -881445, 368665, -1451743, -757279, -914817, -1824480, -1088407, -467803, -1644418, -231312, -481952, -1409819, -37156, -440366, -1996424, 1236499, -907885, 587648, -144193, -667571, 1270787, 720315, 859386, -1962260, 963156, 6258, -426545, 1263651, 233881, 494897, 621746, 1097378, 1920027, 991492, 501990, 825121, 86832, 741552, 113348, 163595, 1145490, -1112007, -1350891, -1415736, 1325511, -1271080, -1579672, -889271, 386457, 1013707, 947719, 1097956, 1472583, 1493782, -1379147, 620853, 659422, -1505162, 1782522, -1243027, -1601594, -1029963, -537928, -394552, -1841049, -1309532, -493756, 842263, 246519, -1709168, -1707127, 680168, 810680, -1236647, -1283006, -900152, 666276, -1380547, -176465, -846736, -1616061, 930848, -328605, -1657989, -654182, -469339, 1400003, -810437, -1983548, -567417, -1049492, 414029, -1888573, -1582642, -1898319, -641132, -1083911, 685374, 399334, 101887, 14803, 324506, 936690, -398412, 563759, 410169, -965331, 929931, -412118, -1975446, 911026, 1137568, -1105671, -1009035, 1073309, -1126235, -326505, 1008636, -1510501, -1768360, -1484093, -887468, 502507, -536164, -212249, -1700552, -308065, 459632, 1679807, 1755654, 237024, -307051, 170218, 6451, -324186, 1174805, -1919806, 508145, 416817, 1114067, -1503892, 1556500, -1351842, -1412709, 1045409, 1747071, 6022, 1485927, -591223, 424144, -694960, 246554, -1764055, -1694970, 226033, -1869922, -1725270, 1943421, -1390954, 1013323, -614259, -1642517, 344043, 1785162, 921210, 40545, -871426, 726648, -962212, 1123161, 377613, 346001, -1239636, -898126, -1635735, 621458, 1138287, 1881790, -1984852, 718488, -1216754, -213901, 496046, 330738, 199050, -1086403, -746963, -415405, 1772919, -394191, -1581737, -1005852, -946110, 1155817, -690512, 1868609, 1604374, -1644551, 596223, 1965621, -1990654, 1433493, 1070906, -2540, -1936647, -841470, 861549, 992232, 922309, -1418490, -1519625, -1197641, -1780864, 1116513, -91413, 1589733, -860646, -1099610, 1479333, -924755, 1158575, 617307, 1348177, -1353414, -669771, 579095, 1190263, -331166, -1763338, -1955831, -473079, 31081, -1746569, -1573175, 1089322, -1636601, -1610857, 470932, 1533066, 1756396, -1379280, -1113977, -1222408, -232173, 1455064, -1842269, 608658, 222285, 914431, 1282507, -1965604, 390244, -1101816, -64511, 885285, -722762, 393398, 1783769, -866, 1902802, 1601164, -1729641, -101261, 1003597, -531847, 973408, -1201347, 1140244, 859144, 959406, 945689, -1978102, -1674032, 585937, 359447, -1755972, 119775, 375651, 225417, -1405015, 479823, -1611111, -503085, -765843, -930570, 216006, 1334276, 113807, -1366060, 80548, -1285805, -189541, -302117, -1569705, -526585, 1647625, -84059, -770475, 1675175, 1452802, -842259, 1751928, 72201, -622196, 1445993, 917275, -1248366, 739239, 1699178, 54309, -1014170, 1328601, -1686776, -1890920, -725387, -1376491, -767429, 329117, 1443385, -1706286, 64604, -1470630, 719606, -931232, 744995, -316141, -1157028, 1262842, 671520, -1993845, -1860431, -497587, 371735, 1773860, -1093920, -1219713, -499170, -304424, 1683211, -317271, 1048389, 408203, -1117212, -1942769, 1878780, 932010, 436313, -314940, 1918908, -832876, 336666, -1658448, -1238860, -1352353, -1902137, -879728, -1099792, -1249380, -357006, 761482, 1361660, -1253422, -370561, -1678136, -774105, 844475, 479951, -1113854, 1168977, 386450, 720943, -751525, 64615, -716914, -1328555, -245530, 1806571, 38969, -941571, -918680, 1016804, -1841467, -1306154, 728592, 1154344, -1611121, 1232237, -1227464, 1024477, -980714, -1943294, 1983788, -841736, -1675436, -549629, -543068, -1919407, 1349116, -1138432, -1268373, 103088, 590413, 277547, 241626, 1694568, -1367145, -1122404, -938594, -130523, 1047083, 1020141, -664941, -1121801, -1172158, 227592, -1907118, 352643, 1998512, -1234773, 12666, 1302823, -1757791, 694707, 747695, 1779683, -402923, 1048128, -572518, 1358762, -12719, -1168017, 846977, 106885, -1240353, 1287745, -1683199, 336042, 671310, -937935, -1665253, -70967, 714752, 689112, 1899814, -1834688, -1538488, -595384, 189801, -300871, 441817, 1301126, -362093, -801589, 978743, 12182, 314996, -1316480, -1043159, 45179, -571739, 904112, -1663499, -649157, -1098193, -816372, 1433813, 947208, -1149555, -185132, -557525, -1855646, -565779, -1506035, -1630374, -908582, -301060, -136688, -1553694, 52395, 1050265, 912044, 1627543, -523942, 1060541, -1293584, -659484, 1157197, -181057, -539102, -1691196, -1640977, 401495, 1440427, 1424073, 285504, 24653, -1746500, 594359, 1724847, -1658682, 642514, 609354, -879819, 350730, 33126, 1624163, 1267972, 1399645, -518198, 660180, 385365, 943937, -1800675, -1734272, 49176, -112696, 163268, 1665585, 1798181, -1343936, -1858286, -1670070, 1611169, -297747, -1231591, -1772402, -1928988, -1139348, -1247587, -1363980, -1234692, 1833130, 822903, 1096315, 1163162, -441625, -199674, 923164, 748174, -811016, -1252865, -1090839, -196607, -1963747, -1329724, 1358481, 656159, -496604, -674379, 989983, 1970594, -1808196, 1074635, 443643, -560544, 943041, 754844, -413264, 1275772, 1896305, -667089, 1634984, -823625, -863881, -1517865, 1017570, -1812423, 1433997, 1698376, 267101, 1562700, -1672470, -1301866, -1839604, -1713494, -1974180, 1122795, 645429, 584021, -1412693, 1550938, 1836317, -1884348, -25554, -1236581, 1057520, -1262416, 1840391, -984114, 1873201, 804655, -1297616, -1486826, -262795, 457296, -1216271, -130090, 1571260, -1930665, -376638, -1062086, -764426, 538236, -987996, 1546957, 1251698, 1996772, -1087920, 1595182, -1036253, 319394, 176382, 347304, -1347963, -1459220, 1617607, -1900850, 215452, 1906233, 1091657, -1246721, -257465, -1240604, -1076802, -177844, -1757283, -118956, -1063590, -1016944, 144509, -1932575, 1879638, -851784, 9368, -998404, -390556, -239621, -1469683, 1482561, -559226, 608933, -1473867, 1596324, -1133505, 1217492, 396011, -1845609, -1634915, -1968391, 1036400, 898783, -1367374, 834187, 1504751, 1059429, -222424, 713062, 1986631, 36247, 784617, 822957, 1672955, -692744, -141058, -258524, -1438196, -1758342, -1235457, -454228, -174617, -80777, 1345327, 1469176, 1836114, -1166722, 1702432, -35480, 402762, -544127, -1985917, 1009490, 1479644, -1145937, 67842, -1713602, 805758, -805173, -403373, 1274766, 1512751, 1930677, -1730537, 304280, -488111, 912051, -124505, -1232704, -1825179, 1285784, -26010, -1686087, 504560, 1969467, -1684211, -870310, -49590, 1349496, 1418854, -1099360, -276024, -1348476, -279685, -819023, -1045640, -588, 1761578, 279167, 1738495, 172440, 531422, -456497, -1916913, 1927353, 631266, -660958, 529743, 351846, 1154680, 1587301, 597991, 1585097, -997639, 549799, -214998, -1736807, 1510594, -1796424, 382985, 1398952, -720990, -1612822, 1047195, 1822270, 751705, -1323976, -773790, -236208, -1997778, 1998463, 1659190, 710334, -1336491, 101633, -294965, -208081
    };

    ocl_utils::Environment env(config::KERNELS_PATH + config::NAIVE_BITONIC_KERNEL, config::NAIVE_BITONIC_KERNEL_NAME);
    bitonic::sort(env, data);

    std::vector<int> reference {
        -1997778, -1996424, -1993845, -1993435, -1990654, -1985917, -1984852, -1983548, -1978102, -1975446, -1974180, -1968391, -1965604, -1963747, -1962260, -1957641, -1955831, -1955752, -1943294, -1942769, -1936647, -1932575, -1930665, -1928988, -1919806, -1919407, -1918659, -1916913, -1907118, -1902188, -1902137, -1900850, -1898319, -1892777, -1890920, -1888573, -1884348, -1869922, -1860431, -1858286, -1855646, -1846757, -1845609, -1842269, -1841467, -1841049, -1839604, -1835269, -1834688, -1825179, -1824480, -1812423, -1808196, -1800675, -1796424, -1780864, -1779891, -1772402, -1768360, -1765320, -1764055, -1763338, -1758342, -1757791, -1757283, -1755972, -1750687, -1746569, -1746500, -1736807, -1734272, -1730537, -1729641, -1725270, -1721934, -1716336, -1713602, -1713494, -1709168, -1707127, -1706286, -1700552, -1694970, -1691196, -1688228, -1686776, -1686087, -1684211, -1683199, -1678136, -1675436, -1674032, -1672470, -1670070, -1665253, -1663499, -1658682, -1658448, -1657989, -1647076, -1644551, -1644418, -1642517, -1640977, -1636601, -1635735, -1635697, -1634915, -1630374, -1630267, -1616061, -1612822, -1611421, -1611111, -1610857, -1601594, -1591381, -1582642, -1581737, -1579672, -1573414, -1573175, -1569705, -1555570, -1553694, -1538488, -1531091, -1519625, -1517865, -1510501, -1506035, -1505162, -1503892, -1487366, -1486826, -1484093, -1476315, -1474606, -1473867, -1470630, -1469683, -1468640, -1466594, -1459220, -1455598, -1451743, -1438196, -1432918, -1418490, -1415736, -1412709, -1412693, -1409819, -1405015, -1399435, -1390954, -1380547, -1379280, -1379147, -1376491, -1371275, -1367374, -1367145, -1366060, -1363980, -1353414, -1352353, -1351842, -1350891, -1348476, -1347963, -1343936, -1339067, -1336491, -1329724, -1328555, -1323976, -1317066, -1316480, -1312158, -1309532, -1306154, -1303920, -1301866, -1297616, -1293584, -1285805, -1285670, -1283006, -1277410, -1271080, -1268373, -1264006, -1262416, -1253422, -1252865, -1249380, -1248366, -1247587, -1246721, -1243663, -1243027, -1240604, -1240353, -1239636, -1238860, -1236647, -1236581, -1235457, -1234773, -1234692, -1232704, -1231591, -1227464, -1222408, -1219713, -1216754, -1216271, -1202447, -1201347, -1197641, -1188122, -1176596, -1172158, -1168017, -1167107, -1166722, -1157028, -1152135, -1149555, -1145937, -1143796, -1139348, -1138432, -1133505, -1127639, -1126235, -1122404, -1121801, -1120519, -1117212, -1113977, -1113854, -1112007, -1111825, -1106452, -1105671, -1101816, -1099792, -1099610, -1099360, -1098491, -1098193, -1093920, -1090839, -1088407, -1088161, -1087920, -1086403, -1083911, -1077352, -1076802, -1070773, -1063590, -1062086, -1049492, -1045640, -1043159, -1036894, -1036253, -1036084, -1029963, -1025837, -1016944, -1014170, -1010844, -1009035, -1005852, -998404, -997639, -991117, -987996, -984114, -980714, -965331, -962212, -961431, -958939, -953499, -946110, -941571, -938594, -937935, -932204, -931232, -930570, -926778, -924755, -918680, -917419, -914817, -908582, -907885, -900152, -899417, -898126, -891188, -889271, -887468, -881445, -879819, -879728, -871426, -870310, -867020, -863881, -860646, -858403, -855449, -851784, -851010, -846736, -842259, -841736, -841470, -832876, -831698, -823625, -819023, -816372, -812489, -811016, -810437, -805173, -801873, -801589, -799161, -787881, -774105, -773790, -772243, -770475, -767429, -765843, -764426, -763895, -759023, -757299, -757279, -751525, -746963, -738596, -737973, -733363, -725387, -722762, -720990, -718431, -716914, -694960, -692744, -690512, -690423, -676001, -674379, -672546, -669771, -667571, -667089, -664941, -664174, -660958, -659484, -654182, -649157, -641132, -622932, -622196, -614259, -611641, -598723, -595384, -591223, -581293, -572518, -571739, -567417, -565779, -561688, -560544, -559226, -557525, -549629, -545672, -544127, -543068, -541048, -539102, -537928, -536164, -531847, -526585, -525116, -524333, -523942, -521145, -518198, -509802, -507553, -503085, -499170, -497587, -496604, -493756, -488111, -481952, -473079, -469339, -469059, -467803, -456497, -454228, -453035, -441625, -440366, -426545, -415405, -413264, -412118, -408890, -403373, -402923, -398748, -398412, -394552, -394191, -390556, -386089, -376638, -376339, -375866, -370561, -368114, -362093, -359697, -358875, -357006, -354338, -331166, -328605, -326505, -324186, -317271, -316141, -314940, -314922, -308065, -307051, -306346, -304424, -302117, -301060, -300871, -297747, -296765, -294965, -288404, -282059, -279685, -276024, -274604, -270448, -267901, -262795, -260403, -258524, -257465, -253833, -245530, -239621, -236208, -232173, -231312, -222424, -214998, -213901, -212249, -209543, -208081, -206031, -204379, -202457, -199674, -196607, -192392, -189541, -185132, -181057, -177844, -176465, -174617, -167203, -144193, -141058, -136688, -135098, -133871, -130523, -130090, -124505, -118956, -117299, -112696, -109828, -101261, -96470, -91413, -84059, -80777, -79332, -70967, -66217, -64511, -56922, -49590, -37156, -35480, -32425, -26010, -25554, -15497, -12719, -11306, -3363, -2540, -1930, -866, -588, 6022, 6258, 6451, 8660, 9368, 12182, 12666, 14803, 15078, 24653, 31081, 33126, 36247, 38969, 40545, 45179, 49176, 51378, 52395, 54309, 59602, 63776, 64604, 64615, 67842, 72201, 80107, 80548, 86832, 97921, 101633, 101887, 103088, 106885, 113348, 113807, 119775, 144509, 147065, 151496, 163268, 163595, 167694, 170218, 171917, 172440, 175810, 176382, 177201, 189801, 199050, 215452, 216006, 222285, 225417, 226033, 227592, 233881, 237024, 241626, 245981, 246519, 246554, 267101, 277547, 279167, 285504, 301110, 302980, 304280, 304875, 307360, 313432, 314996, 319394, 324506, 329117, 330738, 336042, 336666, 344043, 346001, 347304, 350730, 351846, 352643, 359447, 368665, 371735, 375651, 377613, 382985, 385365, 386450, 386457, 390244, 393398, 396011, 399334, 401495, 402762, 407530, 408203, 410169, 410399, 414029, 416817, 417468, 424144, 436313, 441817, 443643, 457296, 458905, 459632, 464685, 470932, 479823, 479951, 490717, 494897, 496046, 501990, 502507, 504560, 508145, 519762, 521826, 529743, 531422, 534530, 538236, 549799, 563759, 568517, 575958, 576102, 579095, 580447, 584021, 585030, 585937, 587648, 590413, 594359, 596223, 597991, 598579, 602579, 608658, 608933, 609354, 617307, 620853, 621458, 621746, 631266, 641092, 642514, 645429, 656159, 659422, 660180, 666276, 668884, 671310, 671520, 680168, 685374, 689112, 694707, 710334, 712136, 713062, 714752, 718488, 719606, 720315, 720943, 723855, 726648, 728592, 736397, 739239, 741552, 744995, 746941, 747695, 748174, 751705, 754844, 761482, 763142, 765883, 778325, 779234, 784617, 786998, 804655, 805758, 810680, 812326, 814717, 822903, 822957, 824532, 825121, 834187, 837330, 840851, 842263, 844475, 846977, 859144, 859386, 861549, 875822, 883051, 885285, 887992, 898783, 904112, 911026, 912044, 912051, 914431, 917146, 917275, 921210, 922309, 923164, 929402, 929931, 930526, 930848, 932010, 936690, 937891, 941125, 943041, 943937, 945689, 947208, 947719, 959406, 963156, 965371, 973408, 978467, 978743, 989983, 991492, 992232, 999497, 1003597, 1008636, 1009490, 1013323, 1013707, 1014901, 1016804, 1017570, 1020141, 1024477, 1032658, 1036400, 1038834, 1040105, 1041865, 1045409, 1047083, 1047195, 1048128, 1048389, 1050265, 1057520, 1059429, 1060541, 1061270, 1070906, 1073309, 1074425, 1074635, 1076390, 1083934, 1089322, 1091657, 1096315, 1097378, 1097956, 1114067, 1116513, 1121833, 1122795, 1123161, 1137568, 1138287, 1140244, 1144432, 1145490, 1154344, 1154680, 1155817, 1157197, 1158575, 1160539, 1163072, 1168977, 1172242, 1174805, 1183668, 1190263, 1194841, 1195022, 1196450, 1198251, 1217492, 1217849, 1232237, 1236499, 1238865, 1245353, 1251698, 1262842, 1263651, 1267972, 1270787, 1271566, 1274766, 1275772, 1277713, 1282507, 1285784, 1287745, 1301126, 1302823, 1310593, 1325511, 1328601, 1334276, 1336044, 1345225, 1345327, 1348177, 1349116, 1349496, 1358481, 1358762, 1361660, 1368931, 1375225, 1394847, 1398952, 1399645, 1400003, 1410662, 1418854, 1424073, 1433493, 1433813, 1433997, 1434366, 1440427, 1443385, 1445993, 1452802, 1454490, 1455064, 1467186, 1469176, 1470185, 1472583, 1479333, 1479644, 1482561, 1485927, 1492089, 1493782, 1497813, 1499831, 1504751, 1510287, 1510594, 1512630, 1512751, 1514566, 1533066, 1546957, 1550938, 1556500, 1562700, 1565434, 1571260, 1582997, 1585097, 1585633, 1587301, 1589733, 1595182, 1596324, 1601146, 1601164, 1604374, 1611169, 1613349, 1617607, 1624163, 1627543, 1634984, 1638584, 1644816, 1647625, 1653825, 1659190, 1665585, 1672955, 1674644, 1675175, 1679807, 1683211, 1694568, 1698376, 1699178, 1702006, 1702432, 1716912, 1724847, 1725193, 1738495, 1740319, 1747071, 1751928, 1753370, 1755654, 1756396, 1761578, 1768294, 1772919, 1772934, 1773860, 1779683, 1782522, 1783769, 1785162, 1791264, 1798181, 1806076, 1806571, 1822270, 1823178, 1824265, 1833130, 1836114, 1836317, 1836744, 1840391, 1847703, 1852507, 1868609, 1873201, 1878780, 1879638, 1881790, 1887106, 1896305, 1896479, 1899814, 1902802, 1906233, 1918266, 1918908, 1920027, 1923822, 1927353, 1930677, 1934371, 1939005, 1943421, 1965621, 1969467, 1970594, 1983788, 1986631, 1996772, 1998463, 1998512
    };

    ASSERT_EQ(data[901], reference[901]);
}

TEST(FAST_KERNEL, test_1) {
    std::vector<int> data {
        -596182,
        -798199,
        -1574142,
        -30307,
        1284444,
        -952049,
        -1796849,
        -1033270
    };

    ocl_utils::Environment env(config::KERNELS_PATH + config::FAST_BITONIC_KERNEL, config::FAST_BITONIC_KERNEL_NAME);
    bitonic::sort(env, data);

    std::vector<int> reference {
        -1796849,
        -1574142,
        -1033270,
        -952049,
        -798199,
        -596182,
        -30307,
        1284444
    };

    ASSERT_EQ(data, reference);
}

TEST(FAST_KERNEL, test_2) {
    std::vector<int> data {
        -539505, -1193354, -208961, -1470294, -790260, -148734, 1797418, 708185, -38016, 938533, -768538, 49269, 1154596, -229249, -868314, -1406368, 611468, -1319694, 72663, -292238, 1112098, -809794, -605579, 422085, -1456826, -1445498, -273417, 312901, -1807656, 1362499, -809451, 991979, -412051, 1901032, -1733355, 307778, -1570628, -1205356, -543517, -1834755, -1564200, 1012243, -789275, 1573868, 1061467, -1422976, 371311, 248478, 1433772, -161526, 463799, -1563151, -642922, -598553, 1686986, 1451552, -1207150, -1177999, -1786586, 1141822, -990335, -1399520, 879269, -1124299, 1566975, -1173368, -1795668, -496927, -1950037, 110122, 1694350, 388130, 1452929, 875315, -1458148, 212040, -1886264, 1177940, 1435553, 861247, -1436228, 1484707, -450377, 264773, 1014566, -834282, -1618855, -47112, 1201222, 1119274, 1412134, -1095795, -431265, 1175053, 780535, -865296, 1012290, -590309, -370819, -1489164, -714140, 998615, -1547007, 843472, -1954017, -176568, -1684348, -130573, 207286, 560866, 605405, 1554003, 1839194, -137326, -969749, -492190, 459603, 316961, -144860, -1783058, 990142, 1247004, 1699720, -1704467, -1564167, 692694, 1163166, -311451
    };

    ocl_utils::Environment env(config::KERNELS_PATH + config::FAST_BITONIC_KERNEL, config::FAST_BITONIC_KERNEL_NAME);
    bitonic::sort(env, data);

    std::vector<int> reference {
        -1954017, -1950037, -1886264, -1834755, -1807656, -1795668, -1786586, -1783058, -1733355, -1704467, -1684348, -1618855, -1570628, -1564200, -1564167, -1563151, -1547007, -1489164, -1470294, -1458148, -1456826, -1445498, -1436228, -1422976, -1406368, -1399520, -1319694, -1207150, -1205356, -1193354, -1177999, -1173368, -1124299, -1095795, -990335, -969749, -868314, -865296, -834282, -809794, -809451, -790260, -789275, -768538, -714140, -642922, -605579, -598553, -590309, -543517, -539505, -496927, -492190, -450377, -431265, -412051, -370819, -311451, -292238, -273417, -229249, -208961, -176568, -161526, -148734, -144860, -137326, -130573, -47112, -38016, 49269, 72663, 110122, 207286, 212040, 248478, 264773, 307778, 312901, 316961, 371311, 388130, 422085, 459603, 463799, 560866, 605405, 611468, 692694, 708185, 780535, 843472, 861247, 875315, 879269, 938533, 990142, 991979, 998615, 1012243, 1012290, 1014566, 1061467, 1112098, 1119274, 1141822, 1154596, 1163166, 1175053, 1177940, 1201222, 1247004, 1362499, 1412134, 1433772, 1435553, 1451552, 1452929, 1484707, 1554003, 1566975, 1573868, 1686986, 1694350, 1699720, 1797418, 1839194, 1901032
    };

    ASSERT_EQ(data, reference);
}

TEST(FAST_KERNEL, test_3) {
    std::vector<int> data {
        1227984, 1208785, -1040021, 1157899, -897755, 436432, 1488111, -1046235, 498618, 104002, -1876387, -1483746, 482842, 1291462, -1634350, 1824695, -1054885, -859099, 1255196, 1848869, 406605, -456520, 773826, 816654, 1717993, -1665797, -380700, 1522879, -969009, 757008, -370780, -1932624, -1953366, -1335742, 1806018, -898096, 1557929, -1676227, 961294, -75426, 1091554, -1428673, -879770, -1925638, -1035690, -1179956, 1843198, -482434, 1679966, -979049, 1666044, 1082621, -1485482, -962663, -162910, 175553, -1369381, -860933, -515058, 579856, 1822211, -1254332, 1486907, -1105306, -1205795, 1226448, -1132154, 509884, -1875328, 1228136, -33188, 1519395, 780654, 279641, -1486093, 1460073, -588164, -362389, 1518291, 1275478, -331965, 1808388, -508279, -251469, -548865, 1757468, 1358141, 67723, 1207334, -1775931, 62708, -576053, -277866, 977672, 1550130, 254276, 441131, 1269339, 1834238, -1500178, 912528, -1959631, 1871670, 1853375, 1895025, 763433, 1005011, 638620, 738330, 1190514, -794135, 890414, -1114983, -1659042, 932108, 780806, 236621, 1136477, -1049838, -1611981, 571428, 1464247, 1054142, 1316463, -1564914, -1668149, 1751682, 1043092, 1919608, 1968728, -20234, -1311894, 953731, -187847, -798966, -1213731, 1393600, 1891795, -1615374, 1613665, -297173, -859592, 1309718, 1342513, 956712, -869978, -620544, -374107, 1718499, 609392, -1716340, -14114, 1518411, 214600, 1928477, 384577, -1982326, -1754958, 79, 245478, -1708687, -37385, -575918, 702538, -1051842, -1244072, 1683772, 486541, -1273678, -1065640, 1305930, -1260232, 1562021, -1813228, 1834577, -806182, 1160337, -639841, -1241031, -1186816, 1908287, 1373552, -1356474, 1241847, -1435519, -1260628, -274173, -1019359, -648416, 1217282, -954901, 1088658, 1684489, -840354, 1896030, -1676237, -1528278, -1495944, -1445482, -1307461, 296682, -1241464, -524137, -1319248, 528759, -724432, -1496055, 1903504, -263713, 841742, -933342, -1259019, 1313156, 1236212, -1114058, -581051, 1249176, -17968, -1769374, 1851473, -949077, 1687862, 862544, -335219, -218332, -1659207, -1598192, -750948, 596286, 700297, 1682720, 411612, 1413546, -668839, -766046, -1819443, -1593372, -39770, -755772, 1457899, -470433, -313610, -1166161, -1274942, 1898060, -710642, 1407222, -1358317, 5829, -1394230, 1389796, 1719667, -1785041, -1973024, 1518900, -365855, 140583, 74079, -973988, 1551007, 732348, -1037781, -1342631, 1944755, -1433245, 1859271, 1203439, -1298100, 1097832, 626785, 1563701, -1850248, -747724, -587149, 1766173, -391014, -1567310, 1180710, -353391, 1830492, -50169, -767944, 378101, 1470010, 1173320, -560081, 270534, -1090988, 1383739, -1740360, -582669, -629074, 647341, -1555888, -290762, -1504331, 1535160, -1445967, -424922, 1326989, 1688120, -1177837, 136564, -1304281, -1627661, -1776116, 1647551, -119351, -1468357, -1461805, -1763655, -295050, 329524, -1781548, 1725282, 1856493, 1750175, -645620, 1461265, 999376, -597990, 1601796, -1840080, 1004975, 1081973, 733790, 388182, -131737, -512555, -1204132, 1968585, -102975, 1604418, -1506056, 453387, 1815058, -560160, -1146443, -647082, 1637788, 920881, -1515590, -1092675, 926092, 1737194, -1107480, -1273668, 1250423, 513824, -166974, 339208, 1797443, 614098, -68434, -522942, 993264, -1615050, 1613794, 877937, -1764432, 429984, -1321636, 457695, 467521, -1083963, -858483, -490788, 1841791, -1084959, -1923063, 1214664, 719070, -360083, 1566945, -847672, -1379075, -674589, -494435, 1150114, -1019785, 829409, -482977, 1795351, -382690, 1831571, 278643, -1254547, -924382, -889278, 919712, -893402, -56734, 949530, -53118, 530894, -1986345, 1527816, 237954, 414407, -670221, -1011443, -1378266, -1580062, -31193, 1400513, 100857, -715768, 1186410, -1402567, 116320, -790274, 299135, -1506516, -1101109, 567961, -1471117, -122497, -783749, -1060714, 952538, -700949, 286897, -1205491, -1307033, -601531, 1646025, 1412292, -211334, 30914, -174991, 811101, 1501813, -1146078, 525256, 529391, -544635, 1792423, -1731017, -268016, 1669384, 742581, -1974003, -533923, -1809419, -498840, -634003, -1184632, -828824, 194765, 263256, -1487521, -1747924, -101344, 1747846, -1595198, 1971380, -153736, 1859511, -1469593, -1132777, -1795315, 1515336, -1288060, -740566, -1642452, -910677, 970874, 1959876, 890873, 726815, -1366414, 429444, -1611177, -36310, 244003, -592371, -368932, -1931047, 1320698, -1880422, 1406967, 468875, 1596043, -1032905, -1530928, 1372288, -1783589, 177717, -935704, 1924221, -1248670, 677938, 1129877, -615716, -1225838, 1674452, -649433, 908499, -249054, 1212453, 1824761, 386668, -985544, -1919090, -359630, 568234, -589372, 1996326, -1483819, 753404, 1637936, -617605, -572693, -1903859, 447411, 1438768, 903667, 284317, 314074, -1334630, 978515, -532155, 197826, -471460, 551101, -138284, -1112083, 1535978, -247026, 1409182, 1386172, 1116759, 1023996, -434204, -429333, -600680, -752552, -1765748, 1118234, 239683, 1868053, 335200, -1501685, -1618500, 1845586, 1936666, 533051, 401614, 1566477, 827622, 913152, -1756750, -1739070, -1889887, -571293, 1103574, 1073129, -1934590, 1548868, -1430971, 699821, -399758, -872043, 1277737, -52891, 839362, -1850114, -1905, 596136, 1585497, -1422710, 1753373, -514618, -1232184, -42831, 216672, 1994098, 1256606, -1673386, -1841132, 645570, -535644, 916504, -1997363, -1312573, -879098, 103185, 1288243, -749973, 268131, 1651054, -954226, 1856456, -200958, -1879945, 1846235, -260307, -233949, 1413645, -1653326, -1208071, -979369, -1901749, -35122, -278090, 1314950, -1450648, 1402109, -1706533, -1772598, -1456662, -199667, 1697823, 1322856, 1670410, 315308, -1904143, 1013248, 784839, -1752312, 1205665, 67609, -997278, -1321582, -748507, 1433988, -1146341, 496420, 807438, 1083547, 1880684, -1135258, -563292, 1815076, 1611536, 1780062, -1767154, 582877, -1096413, -1143575, -1488818, 1327445, -1537101, 319047, -236629, -260592, 576919, 1773738, 1137427, -268677, -473933, -885755, 139670, 396609, 1643231, -1540091, -1057504, -980124, -457791, -1089889, -1316050, -381402, 1505508, 695705, 939031, 683868, 1944117, 755392, 1004544, 1131761, -836284, 918885, 17469, 625371, -642826, 1498121, -1885293, -1342075, -1831123, -1185383, 473914, -75138, 671204, 1090084, 623473, 1430232, -717893, -472529, 280658, 1189097, -1712295, 752291, -522446, -1717613, 1629903, -1405657, 1899491, -98168, -1815378, 1288250, 312676, 332499, -847203, -936969, -1760934, -1411414, -114142, 1224659, 1530638, 128916, 1972708, -346977, -1440239, -1943507, -145707, 1132817, 415942, -1103461, -522158, 923997, -1893169, 874887, 1144455, -1892375, -1634767, -1537727, 1610798, 412735, -117156, 1463041, -118236, -156194, 1931512, -1652063, 675313, -1725319, 95615, 1140703, 168514, -1739541, -1866954, 1854967, -1167138, -1178990, 1755001, 1974093, -1267670, 1869348, 296636, 1695968, -779911, -1550740, -144134, 983558, -120537, -728184, 1427403, 847496, 1971841, -1264293, 1579188, -1224057, 1267803, 851428, -719246, -570701, -814140, -1304547, -1975347, -1800118, -1173027, -495574, 1564535, -261448, -1366299, -807245, -1078826, -481056, 1171683, -625604, 1144192, 868956, 522633, 175842, -1503586, -515703, -1744234, 1672263, -272500, 44914, -1395115, -1283953, 256632, -1935479, 1928548, -1654366, -1375311, 74051, -1589341, -204999, 562024, 803182, 804202, 547999, 541891, 1512295, -494575, 1754834, 1921416, -1033421, 1587477, 693773, -904553, -61664, -118898, -1746002, -660769, -1000749, 1161853, -455434, -1839421, -869612, 1332724, -1356128, -1546899, 629175, 65365, -378458, 1939377, 1762342, 925443, 1755841, 1052018, -193715, 1730237, -1385404, 1509640, 696790, 372194, -931529, 785574, -1595677, -1678456, -688495, 177196, -1186704, -847006, -1625006, -629017, -723183, -170079, -525509, -73101, 1389896, -1120239, 1051006, 675940, -1656488, 356118, 280157, -31738, -1784650, 1451180, 1269498, -983161, 516894, -1887676, 1303851, -549644, 143887, 1957795, 1974454, -647980, 1685720, -1080559, -1763415, 107720, -1038225, 912600, 1564408, -1114427, -142000, 1816498, -688089, 1077922, -1612920, 744617, -667355, 148537, -1867682, -987249, 1850969, 932787, -896062, -1108775, 651479, -1612541, 905114, 779980, -1424170, -1784318, 472243, 701312, -1666349, -1683975, -1526409, -1507697, 270334, -315940, -40700, 812061, 672435, 1050794, -1626567, 1414797, -165240, -186425, 1621015, 1734088, -1392576, 1768393, 1763727, 1991825, 595763, 203480, -259748, 780594, -1943579, -1039016, -68800, -1111106, -779975, -514620, 1563935, -881804, -234674, 1920937, -376428, 549500, -1708601, 145760, -1665294, 1491592, -1869884, -1860582, -157863, -58586, 54011, 1937163, 716709, -1388988, -1660112, 677348, 1282706, -1608086, -1660486, 1449287, -294226, -88574, -722654, -1948882, 1820953, 1154483, -967484, -1404565, 865382, 1489557, 675050, -1077334, -383791, 769754, 1142086, 395005, -1700565, -661113, -606656, -1270940, -1218663, -555468, 328852, -345094, 618736, -448921, -1420389, 891248, -1319456, -1284155, -647504, -38591, -1211218, -1195880, -1528117, 1741547, 37510, 1357172, 927318, -1731627, -560113, 1196468, 1413670, -1597915, -1847388, -781809, -244442, -1275013, -79712, 1801074, 460280, -150110, 590903, 1471115, 755023, -405504, 849414, -1981134, 448519, -202922, 939440, 491658, -959085, 1352382, 1924651, 1729413, 274521
    };

    ocl_utils::Environment env(config::KERNELS_PATH + config::FAST_BITONIC_KERNEL, config::FAST_BITONIC_KERNEL_NAME);
    bitonic::sort(env, data);

    std::vector<int> reference {
        -1997363, -1986345, -1982326, -1981134, -1975347, -1974003, -1973024, -1959631, -1953366, -1948882, -1943579, -1943507, -1935479, -1934590, -1932624, -1931047, -1925638, -1923063, -1919090, -1904143, -1903859, -1901749, -1893169, -1892375, -1889887, -1887676, -1885293, -1880422, -1879945, -1876387, -1875328, -1869884, -1867682, -1866954, -1860582, -1850248, -1850114, -1847388, -1841132, -1840080, -1839421, -1831123, -1819443, -1815378, -1813228, -1809419, -1800118, -1795315, -1785041, -1784650, -1784318, -1783589, -1781548, -1776116, -1775931, -1772598, -1769374, -1767154, -1765748, -1764432, -1763655, -1763415, -1760934, -1756750, -1754958, -1752312, -1747924, -1746002, -1744234, -1740360, -1739541, -1739070, -1731627, -1731017, -1725319, -1717613, -1716340, -1712295, -1708687, -1708601, -1706533, -1700565, -1683975, -1678456, -1676237, -1676227, -1673386, -1668149, -1666349, -1665797, -1665294, -1660486, -1660112, -1659207, -1659042, -1656488, -1654366, -1653326, -1652063, -1642452, -1634767, -1634350, -1627661, -1626567, -1625006, -1618500, -1615374, -1615050, -1612920, -1612541, -1611981, -1611757, -1608086, -1598192, -1597915, -1595677, -1595198, -1593372, -1589341, -1580062, -1567310, -1564914, -1555888, -1550740, -1546899, -1540091, -1537727, -1537101, -1530928, -1528278, -1528117, -1526409, -1515590, -1507697, -1506516, -1506056, -1504331, -1503586, -1501685, -1500178, -1496055, -1495944, -1488818, -1487521, -1486093, -1485482, -1483819, -1483746, -1471117, -1469593, -1468357, -1461805, -1456662, -1450648, -1445967, -1445482, -1440239, -1435519, -1433245, -1430971, -1428673, -1424170, -1422710, -1420389, -1411414, -1405657, -1404565, -1402567, -1395115, -1394230, -1392576, -1388988, -1385404, -1379075, -1378266, -1375311, -1369381, -1366414, -1366299, -1358317, -1356474, -1356128, -1342631, -1342075, -1335742, -1334630, -1321636, -1321582, -1319456, -1319248, -1316050, -1312573, -1311894, -1307461, -1307033, -1304547, -1304281, -1298100, -1288060, -1284155, -1283953, -1275013, -1274942, -1273678, -1273668, -1270940, -1267670, -1264293, -1260628, -1260232, -1259019, -1254547, -1254332, -1248670, -1244072, -1241464, -1241031, -1232184, -1225838, -1224057, -1218663, -1213731, -1211218, -1208071, -1205795, -1205491, -1204132, -1195880, -1186816, -1186704, -1185383, -1184632, -1179956, -1178990, -1177837, -1173027, -1167138, -1166161, -1146443, -1146341, -1146078, -1143575, -1135258, -1132777, -1132154, -1120239, -1114983, -1114427, -1114058, -1112083, -1111106, -1108775, -1107480, -1105306, -1103461, -1101109, -1096413, -1092675, -1090988, -1089889, -1084959, -1083963, -1080559, -1078826, -1077334, -1065640, -1060714, -1057504, -1054885, -1051842, -1049838, -1046235, -1040021, -1039016, -1038225, -1037781, -1035690, -1033421, -1032905, -1019785, -1019359, -1011443, -1000749, -997278, -987249, -985544, -983161, -980124, -979369, -979049, -973988, -969009, -967484, -962663, -959085, -954901, -954226, -949077, -936969, -935704, -933342, -931529, -924382, -910677, -904553, -898096, -897755, -896062, -893402, -889278, -885755, -881804, -879770, -879098, -872043, -869978, -869612, -860933, -859592, -859099, -858483, -847672, -847203, -847006, -840354, -836284, -828824, -814140, -807245, -806182, -798966, -794135, -790274, -783749, -781809, -779975, -779911, -767944, -766046, -755772, -752552, -750948, -749973, -748507, -747724, -740566, -728184, -724432, -723183, -722654, -719246, -717893, -715768, -710642, -700949, -688495, -688089, -674589, -670221, -668839, -667355, -661113, -660769, -649433, -648416, -647980, -647504, -647082, -645620, -642826, -639841, -634003, -629074, -629017, -625604, -620544, -617605, -615716, -606656, -601531, -600680, -597990, -592371, -589372, -588164, -587149, -582669, -581051, -576053, -575918, -572693, -571293, -570701, -563292, -560160, -560113, -560081, -555468, -549644, -548865, -544635, -535644, -533923, -532155, -525509, -524137, -522942, -522446, -522158, -515703, -515058, -514620, -514618, -512555, -508279, -498840, -495574, -494575, -494435, -490788, -482977, -482434, -481056, -473933, -472529, -471460, -470433, -457791, -456520, -455434, -448921, -434204, -429333, -424922, -405504, -399758, -391014, -383791, -382690, -381402, -380700, -378458, -376428, -374107, -370780, -368932, -365855, -362389, -360083, -359630, -353391, -346977, -345094, -335219, -331965, -315940, -313610, -297173, -295050, -294226, -290762, -278090, -277866, -274173, -272500, -268677, -268016, -263713, -261448, -260592, -260307, -259748, -251469, -249054, -247026, -244442, -236629, -234674, -233949, -218332, -211334, -204999, -202922, -200958, -199667, -193715, -187847, -186425, -174991, -170079, -166974, -165240, -162910, -157863, -156194, -153736, -150110, -145707, -144134, -142000, -138284, -131737, -122497, -120537, -119351, -118898, -118236, -117156, -114142, -102975, -101344, -98168, -88574, -79712, -75426, -75138, -73101, -68800, -68434, -61664, -58586, -56734, -53118, -52891, -50169, -42831, -40700, -39770, -38591, -37385, -36310, -35122, -33188, -31738, -31193, -20234, -17968, -14114, -1905, 79, 5829, 17469, 30914, 37510, 44914, 54011, 62708, 65365, 67609, 67723, 74051, 74079, 95615, 100857, 103185, 104002, 107720, 116320, 128916, 136564, 139670, 140583, 143887, 145760, 148537, 168514, 175553, 175842, 177196, 177717, 194765, 197826, 203480, 214600, 216672, 236621, 237954, 239683, 244003, 245478, 254276, 256632, 263256, 268131, 270334, 270534, 274521, 278643, 279641, 280157, 280658, 284317, 286897, 296636, 296682, 299135, 312676, 314074, 315308, 319047, 328852, 329524, 332499, 335200, 339208, 356118, 372194, 378101, 384577, 386668, 388182, 395005, 396609, 401614, 406605, 411612, 412735, 414407, 415942, 429444, 429984, 436432, 441131, 447411, 448519, 453387, 457695, 460280, 467521, 468875, 472243, 473914, 482842, 486541, 491658, 496420, 498618, 509884, 513824, 516894, 522633, 525256, 528759, 529391, 530894, 533051, 541891, 547999, 549500, 551101, 562024, 567961, 568234, 571428, 576919, 579856, 582877, 590903, 595763, 596136, 596286, 609392, 614098, 618736, 623473, 625371, 626785, 629175, 638620, 645570, 647341, 651479, 671204, 672435, 675050, 675313, 675940, 677348, 677938, 683868, 693773, 695705, 696790, 699821, 700297, 701312, 702538, 716709, 719070, 726815, 732348, 733790, 738330, 742581, 744617, 752291, 753404, 755023, 755392, 757008, 763433, 769754, 773826, 779980, 780594, 780654, 780806, 784839, 785574, 803182, 804202, 807438, 811101, 812061, 816654, 827622, 829409, 839362, 841742, 847496, 849414, 851428, 862544, 865382, 868956, 874887, 877937, 890414, 890873, 891248, 903667, 905114, 908499, 912528, 912600, 913152, 916504, 918885, 919712, 920881, 923997, 925443, 926092, 927318, 932108, 932787, 939031, 939440, 949530, 952538, 953731, 956712, 961294, 970874, 977672, 978515, 983558, 993264, 999376, 1004544, 1004975, 1005011, 1013248, 1023996, 1043092, 1050794, 1051006, 1052018, 1054142, 1073129, 1077922, 1081973, 1082621, 1083547, 1088658, 1090084, 1091554, 1097832, 1103574, 1116759, 1118234, 1129877, 1131761, 1132817, 1136477, 1137427, 1140703, 1142086, 1144192, 1144455, 1150114, 1154483, 1157899, 1160337, 1161853, 1171683, 1173320, 1180710, 1186410, 1189097, 1190514, 1196468, 1203439, 1205665, 1207334, 1208785, 1212453, 1214664, 1217282, 1224659, 1226448, 1227984, 1228136, 1236212, 1241847, 1249176, 1250423, 1255196, 1256606, 1267803, 1269339, 1269498, 1275478, 1277337, 1282706, 1288243, 1288250, 1291462, 1303851, 1305930, 1309718, 1313156, 1314950, 1316463, 1320698, 1322856, 1326989, 1327445, 1332724, 1342513, 1352382, 1357172, 1358141, 1372288, 1373552, 1383739, 1386172, 1389796, 1389896, 1393600, 1400513, 1402109, 1406967, 1407222, 1409182, 1412292, 1413546, 1413645, 1413670, 1414797, 1427403, 1430232, 1433988, 1438768, 1449287, 1451180, 1457899, 1460073, 1461265, 1463041, 1464247, 1470010, 1471115, 1486907, 1488111, 1489557, 1491592, 1498121, 1501813, 1505508, 1509640, 1512295, 1515336, 1518291, 1518411, 1518900, 1519395, 1522879, 1527816, 1530638, 1535160, 1535978, 1548868, 1550130, 1551007, 1557929, 1562021, 1563701, 1563935, 1564408, 1564535, 1566477, 1566945, 1579188, 1585497, 1587477, 1596043, 1601796, 1604418, 1610798, 1611536, 1613665, 1613794, 1621015, 1629903, 1637788, 1637936, 1643231, 1646025, 1647551, 1651054, 1666044, 1669384, 1670410, 1672263, 1674452, 1679966, 1682720, 1683772, 1684489, 1685720, 1687862, 1688120, 1695968, 1697823, 1717993, 1718499, 1719667, 1725282, 1729413, 1730237, 1734088, 1737194, 1741547, 1747846, 1750175, 1751682, 1753373, 1754834, 1755001, 1755841, 1757468, 1762342, 1763727, 1766173, 1768393, 1773738, 1780062, 1792423, 1795351, 1797443, 1801074, 1806018, 1808388, 1815058, 1815076, 1816498, 1820953, 1822211, 1824695, 1824761, 1830492, 1831571, 1834238, 1834577, 1841791, 1843198, 1845586, 1846235, 1848869, 1850969, 1851473, 1853375, 1854967, 1856456, 1856493, 1859271, 1859511, 1868053, 1869348, 1871670, 1880684, 1891795, 1895025, 1896030, 1898060, 1899491, 1903504, 1908287, 1919608, 1920937, 1921416, 1924221, 1924651, 1928477, 1928548, 1931512, 1936666, 1937163, 1939377, 1944117, 1944755, 1957795, 1959876, 1968585, 1968728, 1971380, 1971841, 1972708, 1974093, 1974454, 1991825, 1994098, 1996326
    };

    ASSERT_EQ(data[712], reference[712]);
}


int main(int argc, char** argv) {
    testing::InitGoogleTest(&argc, argv);

    return RUN_ALL_TESTS();
}